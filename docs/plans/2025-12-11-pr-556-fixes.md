# PR #556 Fixes - Outstanding Tasks

## Context

PR: https://github.com/ceedaragents/cyrus/pull/556
Working PR: https://github.com/grandmore/cyrus-self-hosting/pull/2

## Tasks

### Task 1: Move Auth Script into CLI

**Requested by:** Connor
**Comment:** "instead of being in a bash script it'd make more sense for this to be part of the cli"

**Current:** `selfhosting/cyrus-agent-auth.sh` - bash script for authentication
**Requested:** Move this functionality into the CLI itself

---

### Task 2: Consider Architectural Refactor - SelfRefreshingLinearClient

**Requested by:** Connor
**Comment:** "I hadn't seen Proxy before. I'm understanding the use case for it, but I think it probably points at an architecture pattern flaw we may have the fact that this is required? Maybe we should be thinking about a SelfRefreshingLinearClient class?"

**Options:**
1. Keep Proxy pattern (minimal changes, already working)
2. Create `SelfRefreshingLinearClient` class that wraps LinearClient
3. Encapsulate inside `LinearIssueTracker` (Connor's second suggestion)

**Discussion needed:** This is an architectural question - do we refactor or keep the working solution?

---

### Task 3: Rebase on upstream/main

**Issue:** Branch is behind upstream/main and has merge conflicts

**Conflicts in:**
- `packages/edge-worker/src/EdgeWorker.ts`
- `packages/edge-worker/src/SharedApplicationServer.ts`

**Upstream added:**
- `/status` endpoint for process activity monitoring
- Version logging on startup
- `linear_get_agent_sessions` tools

---

### Task 4: Reduce `any` Usage

**Requested by:** Connor
**Comment:** "there is too much use of 'any' in the PR for us to merge yet"

**Locations to fix:**
- `EdgeWorker.ts` - proxy wrapper code
- Need to identify all `any` usages and type them properly where possible

**Note:** Do this last after architectural decisions are made, so we know what each function actually is.

---

## Order of Operations

1. Task 2: Decide on architectural approach (Proxy vs SelfRefreshingLinearClient)
2. Task 1: Move auth script into CLI
3. Task 4: Reduce `any` usage (after we know final function signatures)
4. Task 3: Rebase on upstream/main (last)

---

## Notes

- Promise coalescing fix is already implemented and committed
- All tests currently pass locally
- Connor has push access to the branch if needed
